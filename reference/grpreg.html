<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit a group penalized regression path — grpreg • grpreg</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Fit a group penalized regression path — grpreg"><meta name="description" content="Fit regularization paths for models with grouped penalties over a grid of
values for the regularization parameter lambda. Fits linear and logistic
regression models."><meta property="og:description" content="Fit regularization paths for models with grouped penalties over a grid of
values for the regularization parameter lambda. Fits linear and logistic
regression models."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grpreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/grpreg.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/penalties.html">Penalties</a></li>
    <li><a class="dropdown-item" href="../articles/additive-models.html">Additive models</a></li>
    <li><a class="dropdown-item" href="../articles/adaptive-rescaling.html">Adaptive rescaling</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/grpreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit a group penalized regression path</h1>
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/grpreg/blob/master/R/grpreg.R" class="external-link"><code>R/grpreg.R</code></a></small>
      <div class="d-none name"><code>grpreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit regularization paths for models with grouped penalties over a grid of
values for the regularization parameter lambda. Fits linear and logistic
regression models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">grpreg</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grLasso"</span>, <span class="st">"grMCP"</span>, <span class="st">"grSCAD"</span>, <span class="st">"gel"</span>, <span class="st">"cMCP"</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span>, <span class="st">"poisson"</span><span class="op">)</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  lambda.min <span class="op">=</span> <span class="op">{</span></span>
<span>     <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span> </span>
<span>         <span class="fl">1e-04</span></span>
<span>     <span class="kw">else</span> <span class="fl">0.05</span></span>
<span> <span class="op">}</span>,</span>
<span>  log.lambda <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  dfmax <span class="op">=</span> <span class="va">p</span>,</span>
<span>  gmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">penalty</span> <span class="op">==</span> <span class="st">"grSCAD"</span>, <span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  <span class="va">group.multiplier</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnX <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The design matrix, without an intercept.  <code>grpreg</code>
standardizes the data and includes an intercept by default.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The response vector, or a matrix in the case of multitask learning
(see details).</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>A vector describing the grouping of the coefficients.  For
greatest efficiency and least ambiguity (see details), it is best if
<code>group</code> is a factor or vector of consecutive integers, although
unordered groups and character vectors are also allowed.  If there are
coefficients to be included in the model without being penalized, assign
them to group 0 (or <code>"0"</code>).</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>The penalty to be applied to the model.  For group selection,
one of <code>grLasso</code>, <code>grMCP</code>, or <code>grSCAD</code>.  For bi-level
selection, one of <code>gel</code> or <code>cMCP</code>.  See below for details.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Either "gaussian" or "binomial", depending on the response.</p></dd>


<dt id="arg-nlambda">nlambda<a class="anchor" aria-label="anchor" href="#arg-nlambda"></a></dt>
<dd><p>The number of <code>lambda</code> values.  Default is 100.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A user supplied sequence of <code>lambda</code> values.  Typically,
this is left unspecified, and the function automatically computes a grid of
lambda values that ranges uniformly on the log scale over the relevant range
of lambda values.</p></dd>


<dt id="arg-lambda-min">lambda.min<a class="anchor" aria-label="anchor" href="#arg-lambda-min"></a></dt>
<dd><p>The smallest value for <code>lambda</code>, as a fraction of
<code>lambda.max</code>.  Default is .0001 if the number of observations is larger
than the number of covariates and .05 otherwise.</p></dd>


<dt id="arg-log-lambda">log.lambda<a class="anchor" aria-label="anchor" href="#arg-log-lambda"></a></dt>
<dd><p>Whether compute the grid values of lambda on log scale
(default) or linear scale.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p><code>grpreg</code> allows for both a group penalty and an L2 (ridge)
penalty; <code>alpha</code> controls the proportional weight of the regularization
parameters of these two penalties.  The group penalties' regularization
parameter is <code>lambda*alpha</code>, while the regularization parameter of the
ridge penalty is <code>lambda*(1-alpha)</code>.  Default is 1: no ridge penalty.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Convergence threshhold.  The algorithm iterates until the RMSD
for the change in linear predictors for each coefficient is less than
<code>eps</code>.  Default is <code>1e-4</code>.  See details.</p></dd>


<dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum number of iterations (total across entire path).
Default is 10000.  See details.</p></dd>


<dt id="arg-dfmax">dfmax<a class="anchor" aria-label="anchor" href="#arg-dfmax"></a></dt>
<dd><p>Limit on the number of parameters allowed to be nonzero.  If
this limit is exceeded, the algorithm will exit early from the
regularization path.</p></dd>


<dt id="arg-gmax">gmax<a class="anchor" aria-label="anchor" href="#arg-gmax"></a></dt>
<dd><p>Limit on the number of groups allowed to have nonzero elements.
If this limit is exceeded, the algorithm will exit early from the
regularization path.</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>Tuning parameter of the group or composite MCP/SCAD penalty
(see details).  Default is 3 for MCP and 4 for SCAD.</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>Tuning parameter for the group exponential lasso; defaults to
1/3.</p></dd>


<dt id="arg-group-multiplier">group.multiplier<a class="anchor" aria-label="anchor" href="#arg-group-multiplier"></a></dt>
<dd><p>A vector of values representing multiplicative
factors by which each group's penalty is to be multiplied.  Often, this is a
function (such as the square root) of the number of predictors in each
group.  The default is to use the square root of group size for the group
selection methods, and a vector of 1's (i.e., no adjustment for group size)
for bi-level selection.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>Should the function give a warning if it fails to converge?
Default is TRUE.  See details.</p></dd>


<dt id="arg-returnx">returnX<a class="anchor" aria-label="anchor" href="#arg-returnx"></a></dt>
<dd><p>Return the standardized design matrix (and associated group
structure information)?  Default is FALSE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to other functions (such as gBridge).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object with S3 class <code>"grpreg"</code> containing:</p><dl><dt>beta</dt>
<dd><p>The fitted matrix of coefficients.  The number of rows is equal
to the number of coefficients, and the number of columns is equal to
<code>nlambda</code>.</p></dd>

<dt>family</dt>
<dd><p>Same as above.</p></dd>

<dt>group</dt>
<dd><p>Same as above.</p></dd>

<dt>lambda</dt>
<dd><p>The sequence of <code>lambda</code> values in the path.</p></dd>

<dt>alpha</dt>
<dd><p>Same as above.</p></dd>

<dt>deviance</dt>
<dd><p>A vector containing the deviance of the fitted model at each
value of <code>lambda</code>.</p></dd>

<dt>n</dt>
<dd><p>Number of observations.</p></dd>

<dt>penalty</dt>
<dd><p>Same as above.</p></dd>

<dt>df</dt>
<dd><p>A vector of length <code>nlambda</code> containing estimates of effective number of model parameters all the points along the regularization path.  For details on how this is calculated, see Breheny and Huang (2009).</p></dd>

<dt>iter</dt>
<dd><p>A vector of length <code>nlambda</code> containing the number of iterations until convergence at each value of <code>lambda</code>.</p></dd>

<dt>group.multiplier</dt>
<dd><p>A named vector containing the multiplicative constant applied to each group's penalty.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are two general classes of methods involving grouped penalties: those
that carry out bi-level selection and those that carry out group selection.
Bi-level means carrying out variable selection at the group level as well as
the level of individual covariates (i.e., selecting important groups as well
as important members of those groups).  Group selection selects important
groups, and not members within the group – i.e., within a group,
coefficients will either all be zero or all nonzero.  The <code>grLasso</code>,
<code>grMCP</code>, and <code>grSCAD</code> penalties carry out group selection, while
the <code>gel</code> and <code>cMCP</code> penalties carry out bi-level selection.  For
bi-level selection, see also the <code><a href="gBridge.html">gBridge()</a></code> function.  For
historical reasons and backwards compatibility, some of these penalties have
aliases; e.g., <code>gLasso</code> will do the same thing as <code>grLasso</code>, but
users are encouraged to use <code>grLasso</code>.</p>
<p>Please note the distinction between <code>grMCP</code> and <code>cMCP</code>.  The
former involves an MCP penalty being applied to an L2-norm of each group.
The latter involves a hierarchical penalty which places an outer MCP penalty
on a sum of inner MCP penalties for each group, as proposed in Breheny &amp;
Huang, 2009.  Either penalty may be referred to as the "group MCP",
depending on the publication.  To resolve this confusion, Huang et al.
(2012) proposed the name "composite MCP" for the <code>cMCP</code> penalty.</p>
<p>For more information about the penalties and their properties, please
consult the references below, many of which contain discussion, case
studies, and simulation studies comparing the methods.  If you use
<code>grpreg</code> for an analysis, please cite the appropriate reference.</p>
<p>In keeping with the notation from the original MCP paper, the tuning
parameter of the MCP penalty is denoted 'gamma'.  Note, however, that in
Breheny and Huang (2009), <code>gamma</code> is denoted 'a'.</p>
<p>The objective function for <code>grpreg</code> optimization is defined to be
$$Q(\beta|X, y) = \frac{1}{n} L(\beta|X, y) + $$$$ P_\lambda(\beta)$$ where the loss function L is
the negative log-likelihood (half the deviance) for the specified outcome
distribution (gaussian/binomial/poisson). For more details, refer to the
following:</p><ul><li><p><a href="https://pbreheny.github.io/grpreg/articles/models.html">Models and loss functions</a></p></li>
<li><p><a href="https://pbreheny.github.io/grpreg/articles/penalties.html">Penalties</a></p></li>
</ul><p>For the bi-level selection methods, a locally approximated coordinate
descent algorithm is employed.  For the group selection methods, group
descent algorithms are employed.</p>
<p>The algorithms employed by <code>grpreg</code> are stable and generally converge
quite rapidly to values close to the solution.  However, especially when p
is large compared with n, <code>grpreg</code> may fail to converge at low values
of <code>lambda</code>, where models are nonidentifiable or nearly singular.
Often, this is not the region of the coefficient path that is most
interesting.  The default behavior warning the user when convergence
criteria are not met may be distracting in these cases, and can be modified
with <code>warn</code> (convergence can always be checked later by inspecting the
value of <code>iter</code>).</p>
<p>If models are not converging, increasing <code>max.iter</code> may not be the most
efficient way to correct this problem.  Consider increasing <code>n.lambda</code>
or <code>lambda.min</code> in addition to increasing <code>max.iter</code>.</p>
<p>Although <code>grpreg</code> allows groups to be unordered and given arbitary
names, it is recommended that you specify groups as consecutive integers.
The first reason is efficiency: if groups are out of order, <code>X</code> must be
reordered prior to fitting, then this process reversed to return
coefficients according to the original order of <code>X</code>.  This is
inefficient if <code>X</code> is very large.  The second reason is ambiguity with
respect to other arguments such as <code>group.multiplier</code>.  With
consecutive integers, <code>group=3</code> unambiguously denotes the third element
of <code>group.multiplier</code>.</p>
<p>Seemingly unrelated regressions/multitask learning can be carried out using
<code>grpreg</code> by passing a matrix to <code>y</code>.  In this case, <code>X</code> will
be used in separate regressions for each column of <code>y</code>, with the
coefficients grouped across the responses.  In other words, each column of
<code>X</code> will form a group with m members, where m is the number of columns
of <code>y</code>.  For multiple Gaussian responses, it is recommended to
standardize the columns of <code>y</code> prior to fitting, in order to apply the
penalization equally across columns.</p>
<p><code>grpreg</code> requires groups to be non-overlapping.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Breheny P and Huang J. (2009) Penalized methods for bi-level variable
selection. <em>Statistics and its interface</em>, <strong>2</strong>: 369-380.
<a href="https://doi.org/10.4310/sii.2009.v2.n3.a10" class="external-link">doi:10.4310/sii.2009.v2.n3.a10</a></p></li>
<li><p>Huang J, Breheny P, and Ma S. (2012). A selective review of group
selection in high dimensional models. <em>Statistical Science</em>, <strong>27</strong>: 481-499.
<a href="https://doi.org/10.1214/12-sts392" class="external-link">doi:10.1214/12-sts392</a></p></li>
<li><p>Breheny P and Huang J. (2015) Group descent algorithms for nonconvex
penalized linear and logistic regression models with grouped predictors.
<em>Statistics and Computing</em>, <strong>25</strong>: 173-187. <a href="https://doi.org/10.1007/s11222-013-9424-2" class="external-link">doi:10.1007/s11222-013-9424-2</a></p></li>
<li><p>Breheny P. (2015) The group exponential lasso for bi-level variable
selection. <em>Biometrics</em>, <strong>71</strong>: 731-740. <a href="https://doi.org/10.1111/biom.12300" class="external-link">doi:10.1111/biom.12300</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cv.grpreg.html">cv.grpreg()</a></code>, as well as <code><a href="plot.grpreg.html">plot.grpreg()</a></code> and <code><a href="select.html">select.grpreg()</a></code> methods.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Patrick Breheny</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Birthweight data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Birthwt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Birthwt</span><span class="op">$</span><span class="va">X</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="va">Birthwt</span><span class="op">$</span><span class="va">group</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Linear regression</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Birthwt</span><span class="op">$</span><span class="va">bwt</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grLasso"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-1.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grMCP"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-2.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grSCAD"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-3.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"gel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-4.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"cMCP"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-5.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"AIC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        age1        age2        age3        lwt1        lwt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3.03000773  0.00000000  1.14484129  0.57059454  1.30067773  0.00000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        lwt3       white       black       smoke        ptl1       ptl2m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.90025980  0.29687103 -0.05940071 -0.26940924 -0.23983487  0.01075293 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          ht          ui        ftv1        ftv2       ftv3m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.45620940 -0.44477459  0.01632410  0.00000000 -0.02590741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03869348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.805114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $IC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 419.9884 415.9171 413.0551 410.1149 405.8256 401.0234 395.6942 390.8250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [9] 385.9994 381.6926 378.2296 375.6049 373.2817 371.5483 370.2815 369.4147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [17] 368.8327 368.4968 368.3677 368.4282 368.5912 368.8236 369.1017 369.4053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] 369.7208 370.0378 370.3488 370.6482 370.9327 371.1999 371.4486 371.6783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [33] 371.8892 372.0816 372.2563 372.4144 372.7731 373.3927 374.3380 375.1275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] 375.7750 376.3135 376.7658 377.1486 377.4743 377.7527 377.9913 378.1963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 378.3725 378.5237 378.6542 378.7677 378.8665 378.9522 379.0265 379.0914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 379.1481 379.1975 379.2410 379.2792 379.3131 379.3429 379.3690 379.3920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [65] 379.4122 379.4298 379.4451 379.4586 379.4705 379.4810 379.4903 379.4984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 379.4869 379.4947 379.5017 379.5078 379.5132 379.5180 379.5222 379.5261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] 379.5295 379.5326 379.5354 379.5379 379.5402 379.5422 379.5440 379.5457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [89] 379.5471 379.5484 379.5496 379.5506 379.5515 379.5523 379.5530 379.5537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97] 379.5542 379.5547 379.5551 379.5555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Logistic regression</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Birthwt</span><span class="op">$</span><span class="va">low</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grLasso"</span>, family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-6.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grMCP"</span>, family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-7.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grSCAD"</span>, family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-8.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"gel"</span>, family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-9.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"cMCP"</span>, family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-10.png" alt="" width="480" height="480"></span>
<span class="r-in"><span><span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"BIC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        age1        age2        age3        lwt1        lwt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -1.194072    0.000000    0.000000    0.000000   -6.940487    0.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        lwt3       white       black       smoke        ptl1       ptl2m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -3.133163    0.000000    0.000000    0.000000    1.602972    0.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          ht          ui        ftv1        ftv2       ftv3m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1.806523    0.000000    0.000000    0.000000    0.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06423099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.670807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $IC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 234.6720 230.0990 230.0000 229.9536 229.9441 229.9598 229.9920 230.0346</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [9] 229.2504 229.6901 229.9650 234.2584 234.6746 239.7532 239.9728 242.3188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [17] 242.7281 249.3212 255.2388 261.5262 261.6906 261.8543 265.4466 266.0958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] 266.5227 272.5203 272.7270 272.8737 272.9777 273.0514 273.1027 273.1361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [33] 273.1565 273.1643 273.1700 273.1707 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [65] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [89] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97] 273.1707 273.1707 273.1707 273.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multitask learning (simulated example)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">k</span>, <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Note that group is set up automatically</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">group</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5  6  7  8  9  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: 5 6 7 8 9 10</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpreg-11.png" alt="" width="480" height="480"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last updated: August 01, 2025</p>
</div>

    </footer></div>





  </body></html>

