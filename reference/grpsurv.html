<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit regularization paths for Cox models with grouped penalties over a grid
of values for the regularization parameter lambda."><title>Fit an group penalized survival model — grpsurv • grpreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Fit an group penalized survival model — grpsurv"><meta property="og:description" content="Fit regularization paths for Cox models with grouped penalties over a grid
of values for the regularization parameter lambda."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">grpreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.4.0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/getting-started.html">Getting started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-learn-more">Learn more</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-learn-more">
    <a class="dropdown-item" href="../articles/web/models.html">Models</a>
    <a class="dropdown-item" href="../articles/web/penalties.html">Penalties</a>
    <a class="dropdown-item" href="../articles/web/additive-models.html">Additive models</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pbreheny/grpreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit an group penalized survival model</h1>
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/grpreg/blob/HEAD/R/grpsurv.R" class="external-link"><code>R/grpsurv.R</code></a></small>
      <div class="d-none name"><code>grpsurv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit regularization paths for Cox models with grouped penalties over a grid
of values for the regularization parameter lambda.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">grpsurv</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grLasso"</span>, <span class="st">"grMCP"</span>, <span class="st">"grSCAD"</span>, <span class="st">"gel"</span>, <span class="st">"cMCP"</span><span class="op">)</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">penalty</span> <span class="op">==</span> <span class="st">"grSCAD"</span>, <span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  lambda.min <span class="op">=</span> <span class="op">{</span></span>
<span>     <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span> </span>
<span>         <span class="fl">0.001</span></span>
<span>     <span class="kw">else</span> <span class="fl">0.05</span></span>
<span> <span class="op">}</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  dfmax <span class="op">=</span> <span class="va">p</span>,</span>
<span>  gmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  <span class="va">group.multiplier</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnX <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>The design matrix.</p></dd>


<dt>y</dt>
<dd><p>The time-to-event outcome, as a two-column matrix or
<code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></code> object.  The first column should be time on
study (follow up time); the second column should be a binary variable with 1
indicating that the event has occurred and 0 indicating (right) censoring.</p></dd>


<dt>group</dt>
<dd><p>A vector describing the grouping of the coefficients.  For
greatest efficiency and least ambiguity (see details), it is best if
<code>group</code> is a factor or vector of consecutive integers, although
unordered groups and character vectors are also allowed.  If there are
coefficients to be included in the model without being penalized, assign
them to group 0 (or <code>"0"</code>).</p></dd>


<dt>penalty</dt>
<dd><p>The penalty to be applied to the model.  For group selection,
one of <code>grLasso</code>, <code>grMCP</code>, or <code>grSCAD</code>.  For bi-level
selection, one of <code>gel</code> or <code>cMCP</code>.  See below for details.</p></dd>


<dt>gamma</dt>
<dd><p>Tuning parameter of the group or composite MCP/SCAD penalty
(see details).  Default is 3 for MCP and 4 for SCAD.</p></dd>


<dt>alpha</dt>
<dd><p><code>grpsurv</code> allows for both a group penalty and an L2
(ridge) penalty; <code>alpha</code> controls the proportional weight of the
regularization parameters of these two penalties.  The group penalties'
regularization parameter is <code>lambda*alpha</code>, while the regularization
parameter of the ridge penalty is <code>lambda*(1-alpha)</code>.  Default is 1: no
ridge penalty.</p></dd>


<dt>nlambda</dt>
<dd><p>The number of lambda values.  Default is 100.</p></dd>


<dt>lambda</dt>
<dd><p>A user-specified sequence of lambda values.  By default, a
sequence of values of length <code>nlambda</code> is computed automatically,
equally spaced on the log scale.</p></dd>


<dt>lambda.min</dt>
<dd><p>The smallest value for lambda, as a fraction of
lambda.max.  Default is .001 if the number of observations is larger than
the number of covariates and .05 otherwise.</p></dd>


<dt>eps</dt>
<dd><p>Convergence threshhold.  The algorithm iterates until the RMSD
for the change in linear predictors for each coefficient is less than
<code>eps</code>.  Default is <code>0.001</code>.</p></dd>


<dt>max.iter</dt>
<dd><p>Maximum number of iterations (total across entire path).
Default is 10000.</p></dd>


<dt>dfmax</dt>
<dd><p>Limit on the number of parameters allowed to be nonzero.  If
this limit is exceeded, the algorithm will exit early from the
regularization path.</p></dd>


<dt>gmax</dt>
<dd><p>Limit on the number of groups allowed to have nonzero elements.
If this limit is exceeded, the algorithm will exit early from the
regularization path.</p></dd>


<dt>tau</dt>
<dd><p>Tuning parameter for the group exponential lasso; defaults to
1/3.</p></dd>


<dt>group.multiplier</dt>
<dd><p>A vector of values representing multiplicative
factors by which each group's penalty is to be multiplied.  Often, this is a
function (such as the square root) of the number of predictors in each
group.  The default is to use the square root of group size for the group
selection methods, and a vector of 1's (i.e., no adjustment for group size)
for bi-level selection.</p></dd>


<dt>warn</dt>
<dd><p>Return warning messages for failures to converge and model
saturation?  Default is TRUE.</p></dd>


<dt>returnX</dt>
<dd><p>Return the standardized design matrix?  Default is FALSE.</p></dd>


<dt>...</dt>
<dd><p>Not used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object with S3 class <code>"grpsurv"</code> containing:</p>
<dl><dt>beta</dt>
<dd><p>The
fitted matrix of coefficients.  The number of rows is equal to the number of
coefficients, and the number of columns is equal to <code>nlambda</code>.</p></dd>

<dt>group</dt>
<dd><p>Same as above.</p></dd>
 <dt>lambda</dt>
<dd><p>The sequence of <code>lambda</code>
values in the path.</p></dd>
 <dt>penalty</dt>
<dd><p>Same as above.</p></dd>
 <dt>gamma</dt>
<dd><p>Same as
above.</p></dd>
 <dt>alpha</dt>
<dd><p>Same as above.</p></dd>
 <dt>loss</dt>
<dd><p>The negative partial
log-likelihood of the fitted model at each value of <code>lambda</code>.</p></dd>

<dt>n</dt>
<dd><p>The number of observations.</p></dd>
 <dt>df</dt>
<dd><p>A vector of length
<code>nlambda</code> containing estimates of effective number of model parameters
all the points along the regularization path.  For details on how this is
calculated, see Breheny and Huang (2009).</p></dd>
 <dt>iter</dt>
<dd><p>A vector of length
<code>nlambda</code> containing the number of iterations until convergence at each
value of <code>lambda</code>.</p></dd>
 <dt>group.multiplier</dt>
<dd><p>A named vector containing
the multiplicative constant applied to each group's penalty.</p></dd>


</dl><p>For Cox models, the following objects are also returned (and are necessary
to estimate baseline survival conditonal on the estimated regression
coefficients), all of which are ordered by time on study.  I.e., the ith row
of <code>W</code> does not correspond to the ith row of <code>X</code>):</p>
<dl><dt>W</dt>
<dd><p>Matrix of <code>exp(beta)</code> values for each subject over all
<code>lambda</code> values.</p></dd>
 <dt>time</dt>
<dd><p>Times on study.</p></dd>
 <dt>fail</dt>
<dd><p>Failure
event indicator.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The sequence of models indexed by the regularization parameter <code>lambda</code>
is fit using a coordinate descent algorithm.  In order to accomplish this,
the second derivative (Hessian) of the Cox partial log-likelihood is
diagonalized (see references for details).  The objective function is
defined to be $$Q(\beta|X, y) = \frac{1}{n} L(\beta|X, y) + $$$$
P_\lambda(\beta)$$
where the loss function L is the deviance (-2 times the partial
log-likelihood) from the Cox regression mode.
<a href="https://pbreheny.github.io/ncvreg/articles/web/models.html" class="external-link">See here for more details</a>.</p>
<p>Presently, ties are not handled by <code>grpsurv</code> in a particularly
sophisticated manner.  This will be improved upon in a future release of
<code>grpreg</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Breheny P and Huang J. (2009) Penalized methods for bi-level variable
selection. <em>Statistics and its interface</em>, <strong>2</strong>: 369-380.
<a href="https://doi.org/10.4310/sii.2009.v2.n3.a10" class="external-link">doi:10.4310/sii.2009.v2.n3.a10</a></p></li>
<li><p>Huang J, Breheny P, and Ma S. (2012). A selective review of group
selection in high dimensional models. <em>Statistical Science</em>, <strong>27</strong>: 481-499.
<a href="https://doi.org/10.1214/12-sts392" class="external-link">doi:10.1214/12-sts392</a></p></li>
<li><p>Breheny P and Huang J. (2015) Group descent algorithms for nonconvex
penalized linear and logistic regression models with grouped predictors.
<em>Statistics and Computing</em>, <strong>25</strong>: 173-187. <a href="https://doi.org/10.1007/s11222-013-9424-2" class="external-link">doi:10.1007/s11222-013-9424-2</a></p></li>
<li><p>Breheny P. (2015) The group exponential lasso for bi-level variable
selection. <em>Biometrics</em>, <strong>71</strong>: 731-740. <a href="https://doi.org/10.1111/biom.12300" class="external-link">doi:10.1111/biom.12300</a></p></li>
<li><p>Simon N, Friedman JH, Hastie T, and Tibshirani R. (2011)
Regularization Paths for Cox's Proportional Hazards Model via Coordinate
Descent. <em>Journal of Statistical Software</em>, <strong>39</strong>: 1-13.
<a href="https://doi.org/10.18637/jss.v039.i05" class="external-link">doi:10.18637/jss.v039.i05</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.grpreg.html">plot.grpreg()</a></code>, <code><a href="predict.grpsurv.html">predict.grpsurv()</a></code>, <code><a href="cv.grpreg.html">cv.grpsurv()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Patrick Breheny</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Lung</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Lung</span><span class="op">$</span><span class="va">X</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Lung</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="va">Lung</span><span class="op">$</span><span class="va">group</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">grpsurv</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpsurv-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">X</span>, type<span class="op">=</span><span class="st">'survival'</span>, lambda<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grpsurv-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Last updated 2023-05-17</p>
</div>

    </footer></div>

  

  

  </body></html>

