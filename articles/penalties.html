<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Penalties • grpreg</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Penalties">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grpreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/grpreg.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/penalties.html">Penalties</a></li>
    <li><a class="dropdown-item" href="../articles/additive-models.html">Additive models</a></li>
    <li><a class="dropdown-item" href="../articles/adaptive-rescaling.html">Adaptive rescaling</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/grpreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Penalties</h1>
                        <h4 data-toc-skip class="author">Patrick
Breheny</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/grpreg/blob/master/vignettes/articles/penalties.rmd" class="external-link"><code>vignettes/articles/penalties.rmd</code></a></small>
      <div class="d-none name"><code>penalties.rmd</code></div>
    </div>

    
    
<p><strong>grpreg</strong> fits models that fall into the penalized
likelihood framework, in which we estimate <span class="math inline">\boldsymbol{\beta}</span> by minimizing the
objective function</p>
<p><span class="math display"> Q(\boldsymbol{\beta}|\mathbf{X},
\mathbf{y}) = L(\boldsymbol{\beta}|\mathbf{X},\mathbf{y}) +
P_\lambda(\boldsymbol{\beta}), </span></p>
<p>where <span class="math inline">L(\boldsymbol{\beta}|\mathbf{X},\mathbf{y})</span>
is the loss (deviance) and <span class="math inline">P_\lambda(\boldsymbol{\beta})</span> is the penalty.
This article describes the different penalties available in
<code>grpreg</code>; see <a href="models.html">models</a> for more
information on the different loss functions available.</p>
<p>The following notation is used throughout (recall that the design
matrix <span class="math inline">\mathbf{X}</span> is decomposed into
groups <span class="math inline">\mathbf{X}_1, \mathbf{X}_2,
\ldots</span>:</p>
<ul>
<li>
<span class="math inline">\boldsymbol{\beta}</span> denotes the
entire vector of regression coefficients</li>
<li>
<span class="math inline">\boldsymbol{\beta}_j</span> denotes the
vector of regression coefficients corresponding to the <span class="math inline">j</span>th group</li>
<li>
<span class="math inline">\beta_{jk}</span> denotes <span class="math inline">k</span>th regression coefficient in the <span class="math inline">j</span>th group</li>
<li>
<span class="math inline">\lVert\boldsymbol{\beta}_j\rVert_2</span>
denotes the Euclidean (<span class="math inline">L_2</span>) norm of
<span class="math inline">\boldsymbol{\beta}_j</span>: <span class="math inline">\lVert x\rVert_2 = \sqrt{x_1^2 + x_2^2 +
\ldots}</span>
</li>
<li>
<span class="math inline">\lVert\boldsymbol{\beta}_j\rVert_1</span>
denotes the <span class="math inline">L_1</span> norm of <span class="math inline">\beta_j</span>: <span class="math inline">\lVert
x\rVert_1 = \left\lvert x_1\right\rvert + \left\lvert x_2\right\rvert +
\ldots</span>
</li>
</ul>
<div class="section level2">
<h2 id="group-selection">Group selection<a class="anchor" aria-label="anchor" href="#group-selection"></a>
</h2>
<p>These penalties are sparse at the group level – the coefficients
within a group will either all equal zero or none will equal zero.</p>
<p>If you use any of these penalties, please cite</p>
<ul>
<li>Breheny P and Huang J (2015). Group descent algorithms for nonconvex
penalized linear and logistic regression models with grouped predictors.
<em>Statistics and Computing</em>, <strong>25</strong>: 173-187. [<a href="https://myweb.uiowa.edu/pbreheny/pdf/group-computing.pdf" class="external-link">pdf</a>].</li>
</ul>
<p>The article goes into more mathematical details, discusses issues of
standardization in the group sense, and provides references.</p>
<p>The group lasso was originally proposed in</p>
<ul>
<li>Yuan M. and Lin Y. (2006) Model selection and estimation in
regression with grouped variables. <em>Journal of the Royal Statistical
Society Series B</em>, <strong>68</strong>: 49-67.</li>
</ul>
<div class="section level3">
<h3 id="group-lasso">Group lasso<a class="anchor" aria-label="anchor" href="#group-lasso"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grLasso"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display"> P(\beta) = \lambda\sum_j
\lVert\boldsymbol{\beta}_j\rVert_2 </span></p>
</div>
<div class="section level3">
<h3 id="group-mcp">Group MCP<a class="anchor" aria-label="anchor" href="#group-mcp"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grMCP"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display"> P(\boldsymbol{\beta}) = \sum_j
\textrm{MCP}_{\lambda, \gamma}(\lVert\boldsymbol{\beta}_j\rVert_2)
</span></p>
<p>where <span class="math inline">\textrm{MCP}_{\lambda,
\gamma}(\cdot)</span> denotes the MCP penalty with regularization
parameter <span class="math inline">\lambda</span> and tuning parameter
<span class="math inline">\gamma</span>.</p>
</div>
<div class="section level3">
<h3 id="group-scad">Group SCAD<a class="anchor" aria-label="anchor" href="#group-scad"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grSCAD"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display"> P(\boldsymbol{\beta}) = \sum_j
\textrm{SCAD}_{\lambda, \gamma}(\lVert\boldsymbol{\beta}_j\rVert_2)
</span></p>
<p>where <span class="math inline">\textrm{SCAD}_{\lambda,
\gamma}(\cdot)</span> denotes the SCAD penalty with regularization
parameter <span class="math inline">\lambda</span> and tuning parameter
<span class="math inline">\gamma</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="bi-level-selection">Bi-level selection<a class="anchor" aria-label="anchor" href="#bi-level-selection"></a>
</h2>
<p>These penalties are sparse at both the group and individual levels.
In some groups, all coefficients will equal zero. However, even if a
group is selected, some of the coefficients within that group may still
be zero.</p>
<div class="section level3">
<h3 id="group-exponential-lasso-gel">Group exponential lasso (GEL)<a class="anchor" aria-label="anchor" href="#group-exponential-lasso-gel"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"gel"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display"> P(\beta) = \sum_j f_{\lambda,
\tau}(\lVert\boldsymbol{\beta}_j\rVert_1) </span></p>
<p>where <span class="math inline">f(\cdot)</span> denotes the
exponential penalty with regularization parameter <span class="math inline">\lambda</span> and tuning parameter <span class="math inline">\tau</span>:</p>
<p><span class="math display"> f_{\lambda, \tau}(\theta) =
\frac{\lambda^2}{\tau}\left\{1-\exp\left(-\frac{\tau\theta}{\lambda}\right)\right\}
</span></p>
<p>If you use the GEL penalty, please cite</p>
<ul>
<li>Breheny P (2015). The group exponential lasso for bi-level variable
selection. <em>Biometrics</em>, <strong>71</strong>: 731-740. [<a href="https://onlinelibrary.wiley.com/doi/10.1111/biom.12300/pdf" class="external-link">pdf</a>].</li>
</ul>
</div>
<div class="section level3">
<h3 id="composite-mcp">Composite MCP<a class="anchor" aria-label="anchor" href="#composite-mcp"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"cMCP"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display"> P(\boldsymbol{\beta}) = \sum_j
\textrm{MCP}_{\lambda, \gamma_1} \left( \sum_k \textrm{MCP}_{\lambda,
\gamma_2} (\left\lvert\beta_{jk}\right\rvert) \right) </span></p>
<p>where <span class="math inline">\textrm{MCP}_{\lambda,
\gamma}(\cdot)</span> denotes the MCP penalty with regularization
parameter <span class="math inline">\lambda</span> and tuning parameter
<span class="math inline">\gamma</span>.</p>
<p>If you use the composite MCP penalty, please cite either of the
following papers:</p>
<ul>
<li>Breheny P and Huang J (2009). Penalized methods for bi-level
variable selection. <em>Statistics and Its Interface</em>,
<strong>2</strong>: 369-380. [<a href="https://myweb.uiowa.edu/pbreheny/pdf/Breheny2009.pdf" class="external-link">pdf</a>]</li>
<li>Huang J, Breheny P and Ma S (2012). A selective review of group
selection in high-dimensional models. <em>Statistical Science</em>,
<strong>27</strong>: 481-499. [<a href="https://myweb.uiowa.edu/pbreheny/pdf/Huang2012.pdf" class="external-link">pdf</a>]</li>
</ul>
<p>Please note that there is some confusion around the name “group MCP”.
In the first paper above (2009), the composite MCP penalty was referred
to as the “group MCP” penalty; the second paper (2012), in reviewing the
various kinds of group penalties that had been proposed, recommended
changing the name to “composite MCP” to avoid confusion with the “group
MCP” <a href="#group-mcp">defined above</a>.</p>
</div>
<div class="section level3">
<h3 id="group-bridge">Group bridge<a class="anchor" aria-label="anchor" href="#group-bridge"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gBridge.html">gBridge</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display"> P(\boldsymbol{\beta}) = \lambda \sum_j
K_j^\gamma \lVert\boldsymbol{\beta}_j\rVert_1^\gamma </span></p>
<p>where <span class="math inline">K_j</span> denotes the number of
elements in group <span class="math inline">j</span>.</p>
<p>Please note that the group bridge penalty uses a very different
algorithm from the other penalties. Due to the nature of the penalty,
model fitting is slower and less stable for group bridge models. This
is, in fact, the main motivation of the GEL penalty of Section~: to
offer a more tractable alternative to group bridge that has similar
estimation properties but is much better behaved from a numerical
optimization perspective.</p>
<p>If you use the group bridge penalty, please cite either of the
following papers:</p>
<ul>
<li>Huang J, Ma S, Xie H and Zhang C (2009). A group bridge approach for
variable selection. <em>Biometrika</em>, <strong>96</strong>:
339-355.</li>
<li>Breheny P and Huang J (2009). Penalized methods for bi-level
variable selection. <em>Statistics and Its Interface</em>,
<strong>2</strong>: 369-380. [<a href="%5Chref%7Bhttps://myweb.uiowa.edu/pbreheny/publications/Breheny2009.pdf" class="external-link">pdf</a>]</li>
</ul>
<p>The first paper proposed the method; the second paper proposed the
algorithm that is used in the <code>grpreg</code> package.</p>
</div>
</div>
<div class="section level2">
<h2 id="specifying-an-additional-ridge-component">Specifying an additional ridge component<a class="anchor" aria-label="anchor" href="#specifying-an-additional-ridge-component"></a>
</h2>
<p>For all of the penalties in the previous section, <code>grpreg</code>
allows the specification of an additional ridge (<span class="math inline">L_2</span>) component to the penalty. This will set
<span class="math inline">\lambda_1 = \alpha\lambda</span> and <span class="math inline">\lambda_2=(1-\alpha)\lambda</span>, with the penalty
given by</p>
<p><span class="math display"> P(\boldsymbol{\beta}) =
P_1(\boldsymbol{\beta}|\lambda_1) +
\frac{\lambda_2}{2}\lVert\boldsymbol{\beta}\rVert_2^2, </span></p>
<p>where <span class="math inline">P_1</span> is any of the penalties
from the earlier sections. So, for example</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grLasso"</span>, alpha<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<p>will fit a model with penalty</p>
<p><span class="math display"> P(\beta) = 0.75\lambda\sum_j
\lVert\boldsymbol{\beta}_j\rVert_2 +
\frac{0.25\lambda}{2}\lVert\boldsymbol{\beta}\rVert_2^2. </span></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown-footer-right">
  <p>paste(“Last updated:”, format(Sys.time(), “%B %d, %Y”))</p>
</div>

    </footer>
</div>





  </body>
</html>
