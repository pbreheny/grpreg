<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Penalties • grpreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Penalties">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grpreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/getting-started.html">Getting started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more">
<li><a class="dropdown-item" href="../articles/models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/penalties.html">Penalties</a></li>
    <li><a class="dropdown-item" href="../articles/additive-models.html">Additive models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/grpreg"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Penalties</h1>
                        <h4 data-toc-skip class="author">Patrick
Breheny</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/grpreg/blob/master/vignettes/articles/penalties.rmd" class="external-link"><code>vignettes/articles/penalties.rmd</code></a></small>
      <div class="d-none name"><code>penalties.rmd</code></div>
    </div>

    
    
<p><code>grpreg</code> fits models that fall into the penalized
likelihood framework, in which we estimate <span class="math inline">$\bb$</span> by minimizing the objective
function</p>
<p><span class="math display">$$
Q(\bb|\X, \y) = L(\bb|\X,\y) + P_\lam(\bb),
$$</span></p>
<p>where <span class="math inline">$L(\bb|\X,\y)$</span> is the loss
(deviance) and <span class="math inline">$P_\lam(\bb)$</span> is the
penalty. This article describes the different penalties available in
<code>grpreg</code>; see <a href="models.html">models</a> for more
information on the different loss functions available.</p>
<p>The following notation is used throughout (recall that the design
matrix <span class="math inline">$\X$</span> is decomposed into groups
<span class="math inline">$\X_1, \X_2, \ldots$</span>:</p>
<ul>
<li>
<span class="math inline">$\bb$</span> denotes the entire vector of
regression coefficients</li>
<li>
<span class="math inline">$\bb_j$</span> denotes the vector of
regression coefficients corresponding to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
group</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\beta_{jk}</annotation></semantics></math>
denotes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>th
regression coefficient in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
group</li>
<li>
<span class="math inline">$\norm{\bb_j}_2$</span> denotes the
Euclidean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>)
norm of <span class="math inline">$\bb_j$</span>: <span class="math inline">$\norm{x}_2 = \sqrt{x_1^2 + x_2^2 +
\ldots}$</span>
</li>
<li>
<span class="math inline">$\norm{\bb_j}_1$</span> denotes the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>1</mn></msub><annotation encoding="application/x-tex">L_1</annotation></semantics></math>
norm of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math>:
<span class="math inline">$\norm{x}_1 = \abs{x_1} + \abs{x_2} +
\ldots$</span>
</li>
</ul>
<div class="section level2">
<h2 id="group-selection">Group selection<a class="anchor" aria-label="anchor" href="#group-selection"></a>
</h2>
<p>These penalties are sparse at the group level – the coefficients
within a group will either all equal zero or none will equal zero.</p>
<p>If you use any of these penalties, please cite</p>
<ul>
<li>Breheny P and Huang J (2015). Group descent algorithms for nonconvex
penalized linear and logistic regression models with grouped predictors.
<em>Statistics and Computing</em>, <strong>25</strong>: 173-187. [<a href="https://myweb.uiowa.edu/pbreheny/pdf/group-computing.pdf" class="external-link">pdf</a>].</li>
</ul>
<p>The article goes into more mathematical details, discusses issues of
standardization in the group sense, and provides references.</p>
<p>The group lasso was originally proposed in</p>
<ul>
<li>Yuan M. and Lin Y. (2006) Model selection and estimation in
regression with grouped variables. <em>Journal of the Royal Statistical
Society Series B</em>, <strong>68</strong>: 49-67.</li>
</ul>
<div class="section level3">
<h3 id="group-lasso">Group lasso<a class="anchor" aria-label="anchor" href="#group-lasso"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grLasso"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display">$$ P(\beta) = \lam \sum_j \norm{\bb_j}_2
$$</span></p>
</div>
<div class="section level3">
<h3 id="group-mcp">Group MCP<a class="anchor" aria-label="anchor" href="#group-mcp"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grMCP"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display">$$ P(\bb) = \sum_j \textrm{MCP}_{\lam,
\gamma}(\norm{\bb_j}_2) $$</span></p>
<p>where <span class="math inline">$\textrm{MCP}_{\lam,
\gamma}(\cdot)$</span> denotes the MCP penalty with regularization
parameter <span class="math inline">$\lam$</span> and tuning parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="group-scad">Group SCAD<a class="anchor" aria-label="anchor" href="#group-scad"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grSCAD"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display">$$ P(\bb) = \sum_j \textrm{SCAD}_{\lam,
\gamma}(\norm{\bb_j}_2) $$</span></p>
<p>where <span class="math inline">$\textrm{SCAD}_{\lam,
\gamma}(\cdot)$</span> denotes the SCAD penalty with regularization
parameter <span class="math inline">$\lam$</span> and tuning parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="bi-level-selection">Bi-level selection<a class="anchor" aria-label="anchor" href="#bi-level-selection"></a>
</h2>
<p>These penalties are sparse at both the group and individual levels.
In some groups, all coefficients will equal zero. However, even if a
group is selected, some of the coefficients within that group may still
be zero.</p>
<div class="section level3">
<h3 id="group-exponential-lasso-gel">Group exponential lasso (GEL)<a class="anchor" aria-label="anchor" href="#group-exponential-lasso-gel"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"gel"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display">$$ P(\beta) = \sum_j f_{\lam,
\tau}(\norm{\bb_j}_1) $$</span></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(\cdot)</annotation></semantics></math>
denotes the exponential penalty with regularization parameter <span class="math inline">$\lam$</span> and tuning parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>:</p>
<p><span class="math display">$$ f_{\lam, \tau}(\theta) =
\frac{\lam^2}{\tau}\left\{1-\exp\left(-\frac{\tau\theta}{\lam}\right)\right\}
$$</span></p>
<p>If you use the GEL penalty, please cite</p>
<ul>
<li>Breheny P (2015). The group exponential lasso for bi-level variable
selection. <em>Biometrics</em>, <strong>71</strong>: 731-740. [<a href="https://onlinelibrary.wiley.com/doi/10.1111/biom.12300/pdf" class="external-link">pdf</a>].</li>
</ul>
</div>
<div class="section level3">
<h3 id="composite-mcp">Composite MCP<a class="anchor" aria-label="anchor" href="#composite-mcp"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"cMCP"</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display">$$ P(\bb) = \sum_j \textrm{MCP}_{\lam,
\gam_1} \left( \sum_k \textrm{MCP}_{\lam, \gam_2} (\abs{\beta_{jk}})
\right) $$</span></p>
<p>where <span class="math inline">$\textrm{MCP}_{\lam,
\gamma}(\cdot)$</span> denotes the MCP penalty with regularization
parameter <span class="math inline">$\lam$</span> and tuning parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>.</p>
<p>If you use the composite MCP penalty, please cite either of the
following papers:</p>
<ul>
<li>Breheny P and Huang J (2009). Penalized methods for bi-level
variable selection. <em>Statistics and Its Interface</em>,
<strong>2</strong>: 369-380. [<a href="https://myweb.uiowa.edu/pbreheny/pdf/Breheny2009.pdf" class="external-link">pdf</a>]</li>
<li>Huang J, Breheny P and Ma S (2012). A selective review of group
selection in high-dimensional models. <em>Statistical Science</em>,
<strong>27</strong>: 481-499. [<a href="https://myweb.uiowa.edu/pbreheny/pdf/Huang2012.pdf" class="external-link">pdf</a>]</li>
</ul>
<p>Please note that there is some confusion around the name “group MCP”.
In the first paper above (2009), the composite MCP penalty was referred
to as the “group MCP” penalty; the second paper (2012), in reviewing the
various kinds of group penalties that had been proposed, recommended
changing the name to “composite MCP” to avoid confusion with the “group
MCP” <a href="#group-mcp">defined above</a>.</p>
</div>
<div class="section level3">
<h3 id="group-bridge">Group bridge<a class="anchor" aria-label="anchor" href="#group-bridge"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gBridge.html">gBridge</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p><span class="math display">$$ P(\bb) = \lambda \sum_j K_j^\gamma
\norm{\bb_j}_1^\gamma $$</span></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>j</mi></msub><annotation encoding="application/x-tex">K_j</annotation></semantics></math>
denotes the number of elements in group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.</p>
<p>Please note that the group bridge penalty uses a very different
algorithm from the other penalties. Due to the nature of the penalty,
model fitting is slower and less stable for group bridge models. This
is, in fact, the main motivation of the GEL penalty of Section~: to
offer a more tractable alternative to group bridge that has similar
estimation properties but is much better behaved from a numerical
optimization perspective.</p>
<p>If you use the group bridge penalty, please cite either of the
following papers:</p>
<ul>
<li>Huang J, Ma S, Xie H and Zhang C (2009). A group bridge approach for
variable selection. <em>Biometrika</em>, <strong>96</strong>:
339-355.</li>
<li>Breheny P and Huang J (2009). Penalized methods for bi-level
variable selection. <em>Statistics and Its Interface</em>,
<strong>2</strong>: 369-380. [<a href="%5Chref%7Bhttps://myweb.uiowa.edu/pbreheny/publications/Breheny2009.pdf" class="external-link">pdf</a>]</li>
</ul>
<p>The first paper proposed the method; the second paper proposed the
algorithm that is used in the <code>grpreg</code> package.</p>
</div>
</div>
<div class="section level2">
<h2 id="specifying-an-additional-ridge-component">Specifying an additional ridge component<a class="anchor" aria-label="anchor" href="#specifying-an-additional-ridge-component"></a>
</h2>
<p>For all of the penalties in the previous section, <code>grpreg</code>
allows the specification of an additional ridge
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>)
component to the penalty. This will set <span class="math inline">$\lam_1 = \alpha\lam$</span> and <span class="math inline">$\lam_2=(1-\alpha)\lam$</span>, with the penalty
given by</p>
<p><span class="math display">$$ P(\bb) = P_1(\bb|\lam_1) +
\frac{\lam_2}{2}\norm{\bb}_2^2, $$</span></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>1</mn></msub><annotation encoding="application/x-tex">P_1</annotation></semantics></math>
is any of the penalties from the earlier sections. So, for example</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grLasso"</span>, alpha<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<p>will fit a model with penalty</p>
<p><span class="math display">$$ P(\beta) = 0.75\lam \sum_j
\norm{\bb_j}_2 + \frac{0.25\lam}{2}\norm{\bb}_2^2. $$</span></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last updated 2024-06-13</p>
</div>

    </footer>
</div>





  </body>
</html>
