<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with grpreg • grpreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Getting started with grpreg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grpreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/getting-started.html">Getting started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more">
<li><a class="dropdown-item" href="../articles/models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/penalties.html">Penalties</a></li>
    <li><a class="dropdown-item" href="../articles/additive-models.html">Additive models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/grpreg"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started with grpreg</h1>
                        <h4 data-toc-skip class="author">Patrick
Breheny</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/grpreg/blob/master/vignettes/getting-started.rmd" class="external-link"><code>vignettes/getting-started.rmd</code></a></small>
      <div class="d-none name"><code>getting-started.rmd</code></div>
    </div>

    
    
<p><code>grpreg</code> is an R package for fitting the regularization
path of linear regression, GLM, and Cox regression models with grouped
penalties. This includes group selection methods such as group lasso,
group MCP, and group SCAD as well as bi-level selection methods such as
the group exponential lasso, the composite MCP, and the group bridge.
Utilities for carrying out cross-validation as well as post-fitting
visualization, summarization, and prediction are also provided.</p>
<p>This vignette offers a brief introduction to the basic use of
<code>grpreg</code>. For more details on the package, visit the
<code>grpreg</code> website at <a href="https://pbreheny.github.io/grpreg/" class="external-link uri">https://pbreheny.github.io/grpreg/</a>. For more on the
algorithms used by <code>grpreg</code>, see the original articles:</p>
<ul>
<li><p><a href="https://myweb.uiowa.edu/pbreheny/pdf/Breheny2009.pdf" class="external-link">Breheny, P.
and Huang, J. (2009) Penalized methods for bi-level variable selection.
<em>Statistics and its interface</em>, <strong>2</strong>:
369-380.</a></p></li>
<li><p><a href="https://dx.doi.org/10.1007/s11222-013-9424-2" class="external-link">Breheny,
P. and Huang, J. (2015) Group descent algorithms for nonconvex penalized
linear and logistic regression models with grouped predictors.
<em>Statistics and Computing</em>, <strong>25</strong>:
173-187.</a></p></li>
</ul>
<p>For more information on specific penalties, see <a href="https://pbreheny.github.io/grpreg/articles/web/penalties.html" class="external-link uri">https://pbreheny.github.io/grpreg/articles/web/penalties.html</a>.</p>
<p><code>grpreg</code> comes with a few example data sets; we’ll look at
<code>Birthwt</code>, which involves identifying risk factors associated
with low birth weight. The outcome can either be measured continuously
(<code>bwt</code>, the birth weight in kilograms) or dichotomized
(<code>low</code>) with respect to the newborn having a low birth weight
(under 2.5 kg).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Birthwt</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Birthwt</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Birthwt</span><span class="op">$</span><span class="va">bwt</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">#             age1         age2         age3        lwt1        lwt2         lwt3</span></span>
<span><span class="co"># [1,] -0.05833434  0.011046300  0.029561818  0.12446282 -0.02133871 -0.130731102</span></span>
<span><span class="co"># [2,]  0.13436561  0.055245529 -0.096907046  0.06006722 -0.06922831 -0.033348413</span></span>
<span><span class="co"># [3,] -0.04457006 -0.009415469  0.045088774 -0.05918388  0.03746349  0.004618178</span></span>
<span><span class="co"># [4,] -0.03080577 -0.026243567  0.052489640 -0.05202881  0.02390664  0.019034579</span></span>
<span><span class="co"># [5,] -0.07209862  0.035141739  0.004821882 -0.05441384  0.02832410  0.014571538</span></span>
<span><span class="co"># [6,] -0.03080577 -0.026243567  0.052489640 -0.01386846 -0.03296942  0.049559472</span></span>
<span><span class="co">#      white black smoke ptl1 ptl2m ht ui ftv1 ftv2 ftv3m</span></span>
<span><span class="co"># [1,]     0     1     0    0     0  0  1    0    0     0</span></span>
<span><span class="co"># [2,]     0     0     0    0     0  0  0    0    0     1</span></span>
<span><span class="co"># [3,]     1     0     1    0     0  0  0    1    0     0</span></span>
<span><span class="co"># [4,]     1     0     1    0     0  0  1    0    1     0</span></span>
<span><span class="co"># [5,]     1     0     1    0     0  0  1    0    0     0</span></span>
<span><span class="co"># [6,]     0     0     0    0     0  0  0    0    0     0</span></span></code></pre></div>
<p>The original design matrix consisted of 8 variables, which have been
expanded here into 16 features. For example, there are multiple
indicator functions for race (“other” being the reference group) and
several continuous factors such as age have been expanded using
polynomial contrasts (splines would give a similar structure). Hence,
the columns of the design matrix are <em>grouped</em>; this is what
grpreg is designed for. The grouping information is encoded as
follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="va">Birthwt</span><span class="op">$</span><span class="va">group</span></span>
<span><span class="va">group</span></span>
<span><span class="co">#  [1] age   age   age   lwt   lwt   lwt   race  race  smoke ptl   ptl   ht   </span></span>
<span><span class="co"># [13] ui    ftv   ftv   ftv  </span></span>
<span><span class="co"># Levels: age lwt race smoke ptl ht ui ftv</span></span></code></pre></div>
<p>Here, groups are given as a factor; unique integer codes (which are
essentially unlabeled factors) and character vectors are also allowed
(character vectors do have some limitations, however, as the order of
the groups is left unspecified, which can lead to ambiguity if you also
try to set the <code>group.multiplier</code> option). To fit a group
lasso model to this data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grpreg.html">grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grLasso"</span><span class="op">)</span></span></code></pre></div>
<p>We can then plot the coefficient paths with</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/plot-1.png" width="700"></p>
<p>Notice that when a group enters the model (e.g., the green group),
all of its coefficients become nonzero; this is what happens with group
lasso models. To see what the coefficients are, we could use the
<code>coef</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span>, lambda<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co"># (Intercept)        age1        age2        age3        lwt1        lwt2 </span></span>
<span><span class="co">#  3.02892181  0.14045229  0.62608119  0.37683684  0.74715315 -0.15825582 </span></span>
<span><span class="co">#        lwt3       white       black       smoke        ptl1       ptl2m </span></span>
<span><span class="co">#  0.58290856  0.18344777 -0.06107624 -0.18778377 -0.17422515  0.05710668 </span></span>
<span><span class="co">#          ht          ui        ftv1        ftv2       ftv3m </span></span>
<span><span class="co"># -0.29776948 -0.38050822  0.00000000  0.00000000  0.00000000</span></span></code></pre></div>
<p>Note that the number of physician’s visits (<code>ftv</code>) is not
included in the model at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\lambda=0.05</annotation></semantics></math>.</p>
<p>Typically, one would carry out cross-validation for the purposes of
carrying out inference on the predictive accuracy of the model at
various values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.grpreg.html">cv.grpreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">group</span>, penalty<span class="op">=</span><span class="st">"grLasso"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/cvplot-1.png" width="700">
The coefficients corresponding to the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
that minimizes the cross-validation error can be obtained via
<code>coef</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span>
<span><span class="co"># (Intercept)        age1        age2        age3        lwt1        lwt2 </span></span>
<span><span class="co">#  3.04158282  0.03585964  1.31006421  0.77036812  1.56663368 -0.04705625 </span></span>
<span><span class="co">#        lwt3       white       black       smoke        ptl1       ptl2m </span></span>
<span><span class="co">#  1.15399868  0.26474685 -0.12475165 -0.25602530 -0.26542118  0.16769927 </span></span>
<span><span class="co">#          ht          ui        ftv1        ftv2       ftv3m </span></span>
<span><span class="co"># -0.48892550 -0.44999086  0.06039457  0.01966211 -0.09634012</span></span></code></pre></div>
<p>Predicted values can be obtained via <code>predict</code>, which has
a number of options:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cvfit</span>, X<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>                 <span class="co"># Predictions for new observations</span></span>
<span><span class="co"># [1] 2.547122 3.006659 3.042348 2.564257 2.577717 3.083550</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"ngroups"</span>, lambda<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>  <span class="co"># Number of nonzero groups</span></span>
<span><span class="co"># [1] 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"groups"</span>, lambda<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>   <span class="co"># Identity of nonzero groups</span></span>
<span><span class="co"># [1] race  smoke ptl   ht    ui   </span></span>
<span><span class="co"># Levels: age lwt race smoke ptl ht ui ftv</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"nvars"</span>, lambda<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>    <span class="co"># Number of nonzero coefficients</span></span>
<span><span class="co"># [1] 7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"vars"</span>, lambda<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>     <span class="co"># Identity of nonzero coefficients</span></span>
<span><span class="co"># white black smoke  ptl1 ptl2m    ht    ui </span></span>
<span><span class="co">#     7     8     9    10    11    12    13</span></span></code></pre></div>
<p>Note that the original fit (to the full data set) is returned as
<code>cvfit$fit</code>; it is not necessary to call both
<code>grpreg</code> and <code>cv.grpreg</code> to analyze a data set.
Several other penalties are available, as are methods for logistic
regression and Cox proportional hazards regression.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last updated 2024-06-13</p>
</div>

    </footer>
</div>





  </body>
</html>
